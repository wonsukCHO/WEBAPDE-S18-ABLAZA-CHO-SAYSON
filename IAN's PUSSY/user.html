<html>
    <head>
        <title>MemeHub</title>
        <link rel="stylesheet" type="text/css" href="semantic/semantic.min.css">
        <link href="https://fonts.googleapis.com/css?family=Viga" rel="stylesheet">
        <script
          src="https://code.jquery.com/jquery-3.1.1.min.js"
          integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
          crossorigin="anonymous"></script>
        <script src="semantic/semantic.min.js"></script>
        <script>
            // LEFT-RAIL STICKY
            $(window).scroll(function(e) {
                // Get the position of the location where the scroller starts.
                var scroller_anchor = $(".scroller_anchor").offset().top;
                
                // Check if the user has scrolled and the current position is after the scroller start location and if its not already fixed at the top
                if ($(this).scrollTop() >= scroller_anchor && $('.left-rail').css('position') != 'fixed') {
                    // Change the CSS of the scroller to hilight it and fix it at the top of the screen.
                    $('.left-rail').css({
                        'position': 'fixed',
                        'top':'100px'
                    });
                    // Changing the height of the scroller anchor to that of scroller so that there is no change in the overall height of the page.
                    /*
                    $('.scroller_anchor').css('height', '50px');
                    */
                } else if ($(this).scrollTop() < scroller_anchor && $('.left-rail').css('position') != 'relative') {
                    // If the user has scrolled back to the location above the scroller anchor place it back into the content.
                    // Change the height of the scroller anchor to 0 and now we will be adding the scroller back to the content.
                    $('.scroller_anchor').css('height', '0px');
                    // Change the CSS and put it back to its original position.
                    $('.left-rail').css({
                        'position': 'relative',
                        'top':'0px'
                    });
                }
            });
            
            $(window).scroll(function(e) {
                // Get the position of the location where the scroller starts.
                var scroller_anchor = $(".scroller_anchor2").offset().top;
                
                // Check if the user has scrolled and the current position is after the scroller start location and if its not already fixed at the top
                if ($(this).scrollTop() >= scroller_anchor +20) {
                    $('.logo_tiny').css({
                        'visibility':'visible'
                    });
                } else if ($(this).scrollTop() < scroller_anchor) {
                    $('.scroller_anchor2').css('height', '0px');
                    $('.logo_tiny').css({
                        'visibility':'hidden'
                    });
                }
            });
            
            // MODAL FUNCTIONALITY
            $(function(){
                $("#logout").click(function(){
                    $(".logout").modal('show');
                });
                
                $("#cancel").click(function(){
                    $(".logout").modal('hide');
                });
            
                $(".logout").modal({
                    closable: true
                });
                
                $(".share_modal").modal({
                    closable: true
                });
                
                $("#upload").click(function(){
                    $(".upload_modal").modal('show');
                });
                
                $("#share-button").click(function(){
                    $(".uploadSuccess_modal").modal('show');
                });
                
                $("span.username").click(function(){
                    $(".view_profile1").modal('show');
                });
            
                $(".upload_modal").modal({
                    closable: true
                });
                
                $(".view_modal").modal({
                    closable: true
                });
            });
            
            // OTHER FUNCTIONS 
            function logout(){
                window.location.replace("index.html");
            }
            
            function changeItem(){
                $("a.item.active").removeClass("active")
                $(this).addClass("active")
            }
            
            function inputAppend(id_of_input, text){
                $(id_of_input).val($(id_of_input).val() + text);
            }
            
            var tagArray = [];
            
            function x(){
                console.log("YOU CLICKED DELETE!!!" + $(this).attr('data-tag-name'));
                var input = $(this).attr('data-tag-name');
                
                for (i=0; i<=tagArray.length; i++) {
                    if(tagArray[i] == input) {
                        delete tagArray[i];
                        console.log("deleted " + input);
                    }
                }
                
                $("a").remove("#" + input);
            }
            
            let memes = []
            
            function Meme(link, title, owner, up, down, status, tags){
                this.id = memes.length
                this.link = link
                this.title = title
                this.owner = owner
                this.up = up
                this.down = down
                this.status = status
                this.tags = tags
            }
            
            memes.push(new Meme("https://media1.tenor.com/images/fa3003626b296c420d7dd7e37f794293/tenor.gif?itemid=8511784","my first meme","admin",98,43,"public", ["dank","bouncy","thicc"]))
            
            memes.push(new Meme("https://i.redd.it/pjc8fqpsql711.jpg","dank meme","admin",32,8,"public", ["nsfw","sweet"]))
            
            memes.push(new Meme("https://pics.me.me/when-youre-dead-inside-but-you-still-have-to-carry-31383918.png","my first private meme","admin",2,0,"private", ["rick","morty","depression"]))
            
            memes.push(new Meme("https://images-cdn.9gag.com/photo/amYWEVd_700b.jpg",":^)","admin2",14,29,"public", ["emo","sad","depression"]))
            
            memes.push(new Meme("https://i.pinimg.com/originals/a9/7c/d6/a97cd69b67f634d3da8fe2e4b8c03d8b.jpg","fame monster","admin",0,0,"private", ["spongebob","fame","sad"]))
            
            memes.push(new Meme("https://cdn.dopl3r.com/memes_files/babe-know-everything-about-me-right-of-course-baby-why-whats-up-whats-my-favorite-animal-uhhh-babe-really-thinking-bito-ch-im-shutpc-watermelon-hfr0M.jpg","watermelon","admin2",0,0,"private", ["thicc","watermelon"]))
            
            memes.push(new Meme("https://scontent.fmnl4-3.fna.fbcdn.net/v/t1.0-9/36815664_622757611430699_1700490239543345152_n.png?_nc_cat=0&oh=5d5014f41fbe9d1517bd686cf114fe5b&oe=5BCE13A5","HAHAHA","admin2",120,18,"public", ["computer-science","functions","spiderman"]))
            
            memes.push(new Meme("https://scontent.fmnl4-3.fna.fbcdn.net/v/t1.0-9/36352971_612739159099211_6840377731239116800_n.jpg?_nc_cat=0&oh=7a988b127b5f92e4fafd542f793bee89&oe=5BE4EE01","its super effective","admin",81,9,"public", ["computer-science","comments","struggle"]))
            
            function insertMeme(meme, isUser){
                let memeContainer = document.createElement("div")
                memeContainer.className = "meme_container"
                
                let title = document.createElement("span")
                title.className = "meme_title"
                $(title).text(meme.title)
                let details = document.createElement("span")
                details.className = "meme_details"
                $(details).text("by "+meme.owner)
                
                if (meme.owner == "admin"){
                    $(details).click(function(){
                        $(".view_profile1").modal('show');
                    });
                } else if (meme.owner == "admin2") {
                    $(details).click(function(){
                        $(".view_profile2").modal('show');
                    });
                }
                
                let privateLbl = document.createElement("div")
                privateLbl.className = "ui label private"
                $(privateLbl).text("Private")
                
                if (meme.status=="private")
                    $(title).append(privateLbl)
                $(memeContainer).append(title)
                $(memeContainer).append(details)
                
                let memeImgContainer = document.createElement("div")
                memeImgContainer.className = "meme"
                let memeImg = document.createElement("img")
                $(memeImg).attr("src",meme.link)
                $(memeImg).attr("data-id",meme.id)
                $(memeImgContainer).append(memeImg)
                $(memeContainer).append(memeImgContainer)
                
                let memeStats = document.createElement("div")
                memeStats.className = "meme_stats"
                
                let span1 = document.createElement("span")
                let icon1 = document.createElement("i")
                icon1.className = "chevron circle up icon"
                $(span1).text(meme.up)
                $(span1).append(icon1)
                
                let span2 = document.createElement("span")
                let icon2 = document.createElement("i")
                icon2.className = "chevron circle down icon"
                $(span2).text(meme.down)
                $(span2).append(icon2)
                
                let span3 = document.createElement("span")
                let icon3 = document.createElement("i")
                icon3.className = "share icon"
                $(icon3).click(function(){
                    $(".share_modal").modal('show');
                })
                $(span3).append(icon3)
                
                $(memeStats).append(span1)
                $(memeStats).append(span2)
                if (isUser)
                    $(memeStats).append(span3)
                $(memeContainer).append(memeStats)
                
                $(".wrapper .container.right").append(memeContainer)
            }
            
            function insertMemesUser(user){
                for (let i=0;i<memes.length;i++){
                    if (memes[i].owner == user)
                        insertMeme(memes[i], true)
                    else if (memes[i].status == "public")
                        insertMeme(memes[i], false)
                }
                
                let more = document.createElement("div")
                more.className = "more"
                let btnMore = document.createElement("button")
                btnMore.className = "ui icon button big orange more_memes"
                let downIcon = document.createElement("i")
                downIcon.className = "angle double down icon"
                
                $(btnMore).append(downIcon)
                $(more).append(btnMore)
                $(".wrapper .container.right").append(more)
            }
            
            function viewMeme(){
                let id = $(this).attr('data-id')
                var source = memes[id].link;
                var title = memes[id].title;
                var content ="by " + memes[id].owner
                $("#view_meme_title").text(title);
                
                let editIcon = document.createElement("i")
                editIcon.className = "edit outline icon"
                let delIcon = document.createElement("i")
                delIcon.className = "trash icon"
                
                $("div.view_modal div.header").empty()
                $("div.view_modal div.header").text("View meme")
                if (memes[id].owner=="admin"){
                    $("div.view_modal div.header").append(delIcon)
                    $("div.view_modal div.header").append(editIcon)
                }
                
                let privateLbl = document.createElement("div")
                privateLbl.className = "ui label private"
                $(privateLbl).text("Private")
                
                if(memes[id].status=="private")
                    $("#view_meme_title").append(privateLbl)
                
                $("div.ui.longer.modal.view_modal div.view_meme img").attr("src",source)
                
                $("#view_meme_info").text(content);
                
                if (memes[id].owner=="admin") {
                    $("#view_meme_info").click(function(){
                        window.location.replace("profile1.html");
                    })
                } else {
                    $("#view_meme_info").click(function(){
                        window.location.replace("profile2.html");
                    })
                }
                    
                var taglist = memes[id].tags;
                $("div.ui.longer.modal.view_modal div.tag_holder").empty();
                
                for (i = 0; i < taglist.length; i++) { 
                    var tagname = taglist[i];
                    var newtag = document.createElement("div");
                    newtag.className = "ui label";
                    $(newtag).text(tagname)
                    $("div.ui.longer.modal.view_modal div.tag_holder").append(newtag);
                }
                    
                $(".view_modal").modal('setting', 'transition', 'horizontal flip')
                $(".view_modal").modal('show');
            }
            
            $(document).ready(function(){
                insertMemesUser("admin")
                $("#logout_btn").click(logout)
                $("a.item").click(changeItem)
                
                $(".meme_container img").click(viewMeme)
                
                $('#tags').keypress(function(event){
                    var keycode = (event.keyCode ? event.keyCode : event.which);
                    if(keycode == '13'){
                        console.log("YOU PRESSED ENTER!");
                        var input = $("#tags").val();
                            input = $("#tags").val();
                            
                            input = input.split(' ').join('-');
                        
                            console.log(input);
                            $("#tags").val("");
                            tagArray.push(input);
                            console.log(tagArray.length); //checking array length
                            
                            var inputTag = document.createElement('a');
                            var deleteTag = document.createElement('i');
                            inputTag.className = "ui label";
                            deleteTag.className = "delete icon";
                            
                            $(inputTag).attr('id', input); //setting tag name to id 
                            $(deleteTag).attr('data-tag-name', input);
                            $(deleteTag).click(x);
                            
                            $(inputTag).text(input);
                            $(inputTag).append(deleteTag);
                            
                            $("#textarea").append(inputTag);
                           
                    }
                })
                
                $('#tags2').keypress(function(event){
                    var keycode = (event.keyCode ? event.keyCode : event.which);
                    if(keycode == '13'){
                        console.log("YOU PRESSED ENTER!");
                        var input = $("#tags2").val();
                            input = $("#tags2").val();
                            
                            input = input.split(' ').join('-');
                        
                            console.log(input);
                            $("#tags2").val("");
                            tagArray.push(input);
                            console.log(tagArray.length); //checking array length
                            
                            var inputTag = document.createElement('a');
                            var deleteTag = document.createElement('i');
                            inputTag.className = "ui label";
                            deleteTag.className = "delete icon";
                            
                            $(inputTag).attr('id', input); //setting tag name to id 
                            $(deleteTag).attr('data-tag-name', input);
                            $(deleteTag).click(x);
                            
                            $(inputTag).text(input);
                            $(inputTag).append(deleteTag);
                            
                            $("#textarea3").append(inputTag);
                           
                    }
                })
                
                $('#tags3').keypress(function(event){
                    var keycode = (event.keyCode ? event.keyCode : event.which);
                    if(keycode == '13'){
                        event.preventDefault();
                        console.log("YOU PRESSED ENTER!");
                        var input = $("#tags3").val();
                            input = $("#tags3").val();
                            
                            input = input.split(' ').join('-');
                        
                            console.log(input);
                            $("#tags3").val("");
                            
                            var inputTag = document.createElement('a');
                            var deleteTag = document.createElement('i');
                            inputTag.className = "ui label";
                            deleteTag.className = "delete icon";
                            
                            $(inputTag).attr('id', input); //setting tag name to id 
                            $(deleteTag).attr('data-tag-name', input);
                            $(deleteTag).click(x);
                            
                            $(inputTag).text(input);
                            $(inputTag).append(deleteTag);
                            
                            $("#textarea4").append(inputTag);
                    }
                })
                
                $('#search_tags').keypress(function(event){
                    var keycode = (event.keyCode ? event.keyCode : event.which);
                    if(keycode == '13'){
                        console.log("YOU PRESSED ENTER!");
                        var input = $("#search_tags").val();
                            input = $("#search_tags").val();
                            
                            input = input.split(' ').join('-');
                        
                            console.log(input);
                            $("#search_tags").val("");
                            tagArray.push(input);
                            console.log(tagArray.length); //checking array length
                            
                            var inputTag = document.createElement('a');
                            var deleteTag = document.createElement('i');
                            inputTag.className = "ui label";
                            deleteTag.className = "delete icon";
                            
                            $(inputTag).attr('id', input); //setting tag name to id 
                            $(deleteTag).attr('data-tag-name', input);
                            $(deleteTag).click(x);
                            
                            $(inputTag).text(input);
                            $(inputTag).append(deleteTag);
                            
                            $("#textarea2").append(inputTag);
                    }
                })
                
                $("#private-button").click(function(){
                    $(this).css('background-color', '#20b2aa');
                    $("#public-button").css('background-color', 'darkorange')
                });
               
                $("#public-button").click(function(){
                    $(this).css('background-color', '#20b2aa');
                    $("#private-button").css('background-color', 'darkorange')
                });
                
                $(".more_memes").click(function(){
                    $(this).addClass("loading")
                })
                
                $(".goto_1").click(function(){
                    window.location.replace("profile1.html");
                })
                
                $(".goto_2").click(function(){
                    window.location.replace("profile2.html");
                })
                
                $("a.item").click(function(){
                    window.location.replace("user.html");
                })
            })
        </script>
        
        <link rel="stylesheet" type="text/css" href="custom.css">
    </head>
    <body>
        <!-------UPPER NAV BAR------>
        <div class="ui small menu borderless sticky">
            <a class="active item">Top</a>
            <a class="item">Hot</a>
            <a class="item">Trending</a>
            
            <div class="right menu">
                <div class="logo_tiny">Meme<span class="invert">Hub</span></div>
            </div>
            
            <div class="right menu">
                <div class="item">
                    <div class="ui button orange" id="upload"><i class="upload icon"></i>Upload Meme</div>
                </div>
                <div class="item">
                    <div class="ui button" id="logout"><i class="sign out icon"></i>Logout</div>
                </div>
                    <div class="avatar"><img src="avatar/man-1.png"></div>
            </div>
        </div>
        
        <!-------PARALLAX EFFECT FOR THE BACKGROUND------>
        <div class="parallax"></div>
        
        <!-------WRAPPER FOR LOGO AND MEME DASHBOARD------>
        <div class="wrapper">
            <div class="scroller_anchor2"></div>
            <div class="logo">Meme<span class="invert">Hub</span></div>
            
            <div class="scroller_anchor"></div>
            <div class="left-rail">
                <div class="display_photo"><img src="avatar/man-1.png"></div>
                <div class="small_container container">
                    <div class="header">Welcome, <span class="username">admin</span>!</div>
                    <div class="content">Joined <span class="joined">2 years ago</span>. Uploaded <span class="meme_count">5</span> memes.</div>
                </div>
                <div class="small_container container">
                    <div class="header">Popular Tags</div>
                    <div class="content" id="popular_tags">
                        <a class="ui label">dank</a>
                        <a class="ui label">spicy</a>
                        <a class="ui label">pinoy</a>
                        <a class="ui label">loss</a>
                        <a class="ui label">computer-science</a>
                        <a class="ui label">cool</a>
                    </div>
                </div>
                <div class="small_container container" id="search_container">
                    <div class="header">Search by tags</div>
                    <div class="content">
                        <div class="ui left input" id="searchTag">
                            <input type="text" id="search_tags">
                            <div id="textarea2"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="container right">
            </div>
        </div>
        
        <!-------FOOTER------>
        <div class="ui container">
            GAMUTAN | ONA | PINEDA
        </div>
        
        <!-------PUT MODALS HERE------>
        <!-------LOGOUT MODAL------>
        <div class="ui tiny modal logout">
            <i class="close icon"></i>
            <div class="signup header">Logout</div>
            <div class="content">
                <center>
                    <div class="logo_small">Meme<span class="invert">Hub</span></div>
                    <div class="logout_prompt">
                        Are you sure you want to logout?
                        <div class="logout_buttons">
                            <div class="ui orange button" id="logout_btn">Logout</div>
                            <div class="ui button" id="cancel">Cancel</div>
                        </div>
                    </div>
                </center>
            </div>
        </div>
        
        <!-------UPLOAD MEME MODAL------>
        <div class="ui tiny modal upload_modal">
            <i class="close icon"></i>
            <div class="header">Upload meme</div>
            <div class="scrolling content">
                <form class="ui form">
                    <div class="field">
                        <label>Upload a meme</label>
                        <input type="file" accept="image/png,image/jpg,image/tiff" id="real-file" hidden="hidden"/>
                        <div class="ui button orange" id="custom-button">Choose a file</div>
                        <span id="custom-text">No meme chosen yet</span>
                        <script type="text/javascript">
                            const realFileBtn = document.getElementById("real-file");
                            const customBtn = document.getElementById("custom-button");
                            const customTxt = document.getElementById("custom-text");
                            
                            customBtn.addEventListener("click", function() {
                                realFileBtn.click();
                            });

                            realFileBtn.addEventListener("change", function() {
                                if(realFileBtn.value){ //if a file is chosen
                                    customTxt.innerHTML = realFileBtn.value.match(/[\/\\]([\w\d\s\.\-\(\)]+)$/)[1];
                                } else
                                    customTxt.innerHTML = "No meme chosen yet";
                            });
                        </script>
                    </div>
                    
                    <div class="field">
                        <label>Give your meme a dank title</label>
                        <input type="text" id="title" placeholder="Dank Meme"/>
                    </div>
                    
                    <div class="field">
                        <label>Tags</label>
                        <input type="text" id="tags" placeholder="#doge, #Drake"/>
                        <div id="textarea"></div>
                    </div>
                    
                    <div class="field">
                        <label>Shared users</label>
                        <input type="text" id="tags2" placeholder="admin2, admin"/>
                        <div id="textarea3"></div>
                    </div>
                    
                    <div class="field">
                        <label>Privacy</label>
                        <div class="ui button orange" id="private-button">Private</div>
                        <div class="ui button orange" id="public-button">Public</div>
                    </div>
                    <div class="ui inverted button orange" id="share-button">Upload</div>
                </form>
            </div>
        </div>
        
        <!-------UPLOAD SUCCESS MODAL------>
        <div class="ui tiny modal uploadSuccess_modal">
            <i class="close icon"></i>
            <div class="header">Upload meme</div>
            <div class="scrolling content">
                You have successfully uploaded a meme!
            </div>
        </div>
        
        <!-------SHARE MEME MODAL------>
        <div class="ui small modal share_modal">
            <i class="close icon"></i>
            <div class="header">Share meme</div>
            <div class="content">
                <form class="ui form">
                    <div class="field">
                        <label>Add users to share this meme with</label>
                        <input type="text" id="tags3" placeholder="admin2, admin"/>
                        <div id="textarea4"></div>
                       
                    </div>
                </form>
            </div>
        </div>
        
        <!-------VIEW MEME MODAL------>
        <div class="ui longer modal view_modal">
            <i class="close icon"></i>
            <div class="header">View meme</div>
            <div class="scrolling content">
                <div id="view_meme_title"></div>
                <div id="view_meme_info"></div>
                <center>
                    <div class ="view_meme"><img src="" id="view_meme_img"></div>
                </center>
                <div class="tag_holder"></div>
            </div>
        </div>
        
        <!-------VIEW USER PROFILE 1 MODAL------>
        <div class="ui mini modal view_profile1">
            <i class="close icon"></i>
            <div class="header">admin1</div>
            <div class="content">
                <div class="display_photo"><img src="avatar/man-1.png"></div>
            </div>
            <div class="content">
                    Joined <span class="joined">2 years ago</span>. Uploaded <span class="meme_count">5</span> memes.
                Recent memes:
                <div class="ui tiny images">
                    <img src="https://media1.tenor.com/images/fa3003626b296c420d7dd7e37f794293/tenor.gif?itemid=8511784">
                    <img src="https://i.redd.it/pjc8fqpsql711.jpg">
                    <img src="https://pics.me.me/when-youre-dead-inside-but-you-still-have-to-carry-31383918.png">
                </div>
                View full profile <span class="hyperlink goto_1">here</span>.
            </div>
        </div>
        
        <!-------VIEW USER PROFILE 2 MODAL------>
        <div class="ui mini modal view_profile2">
            <i class="close icon"></i>
            <div class="header">admin2</div>
            <div class="content">
                <div class="display_photo"><img src="avatar/girl-1.png"></div>
            </div>
            <div class="content">
                    Joined <span class="joined">2 years ago</span>. Uploaded <span class="meme_count">3</span> memes.
                Recent memes:
                <div class="ui tiny images">
                    <img src="https://images-cdn.9gag.com/photo/amYWEVd_700b.jpg">
                    <img src="https://scontent.fmnl4-3.fna.fbcdn.net/v/t1.0-9/36815664_622757611430699_1700490239543345152_n.png?_nc_cat=0&oh=5d5014f41fbe9d1517bd686cf114fe5b&oe=5BCE13A5">
                </div>
                View full profile <span class="hyperlink goto_2">here</span>.
            </div>
        </div>
        
    </body>
</html>